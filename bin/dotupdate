#!/usr/local/bin/zsh
# dotupdate - copy file from ~/dotfiles/file to .file
# 	assumes the desired ${SrcFile} is in the ${SrcDir}
type emulate >/dev/null 2>/dev/null || alias emulate=true
emulate -L ksh
if [ -z ${1} ]; then
	echo "Usage: dotupdate [-f] \"filename\" (without '.')" 
else
	case ${1:0:2} in
		-f) Force="Y"
				shift	;;
		-c) Check="Y"
				shift	;;
	esac
	SrcDir="${HOME}/dotfiles"
	DestDir=${HOME}
	cd ${SrcDir}
	for i in $@; do
		SrcFile="$(echo ${i}|sed -e 's/^.//')"
		DestFile=".${SrcFile}"
		if [ ! -e ${SrcDir}/${SrcFile} ]; then
			fg_red "Error: ${SrcDir}/${SrcFile} does not exist."
		elif [ "${DestDir}/${DestFile}" -nt "${SrcDir}/${SrcFile}" ] && [ "${Force}" == "" ]; then
			echo "${DestDir}/${DestFile} is $(fg_red "NEWER") than ${SrcDir}/${SrcFile}"
		elif [ "${Check}" == "Y" ]; then
			echo "${SrcDir}/${SrcFile} $(fg_yellow "will be copied to") ${DestDir}/${DestFile}"
		else
			printf "Copy ${SrcDir}/${SrcFile} $(fg_green "to") ${DestDir}/${DestFile}\n"
			cp -a ${SrcDir}/${SrcFile} ${DestDir}/${DestFile}
		fi
	done
fi
