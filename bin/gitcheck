#!/usr/local/bin/zsh
fg_white "**** Git Working Tree Status ****"
if output=$(git stash list) && [ -z "$output" ]; then
  fg_green "No Stashes saved."
else 
  NumStashes=${$(echo $output|wc -l)##*( )}
  if (( NumStashes > 1 )); then
    stashes="Stashes"
  else
    stashes="Stash"
  fi
  fg_red1 "Yes, ${NumStashes} $stashes saved."
  fg_yellow "  git stash list [to view them]"
fi
if output=$(git ls-files . --exclude-standard --others) && [ -z "$output" ]; then
  fg_green "No Untracked files."
else 
  fg_red1 "Yes, Untracked files."
  fg_red1 "  $(git ls-files . --exclude-standard --others)"
fi
if output=$(git diff --exit-code) && [ -z "$output" ]; then
  fg_green "No changes to be Staged."
else 
  fg_red1 "Yes, changes to be Staged."
  fg_yellow "  git diff [to view them]"
fi
if output=$(git diff --cached --exit-code) && [ -z "$output" ]; then
  fg_green "No staged changes to Commit."
else 
  fg_red1 "Yes, staged changes to Commit."
  fg_yellow "  git diff --cached [to view them]"
fi
if output=$(git cherry -v) && [ -z "$output" ]; then
  fg_green "No commits to Push."
else 
  NumChanges=${$(echo $output|wc -l)##*( )}
  if (( NumChanges > 1 )); then
    changes="Changes"
  else
    changes="Change"
  fi
  fg_red1 "Yes, ${NumChanges} $changes to Push."
  fg_yellow "  git cherry -v [to view them]"
fi
#if [ $LOCAL = $REMOTE ]; then
#    echo "Up-to-date"
#elif [ $REMOTE = $BASE ]; then
#    echo "Need to push"
#else
#    echo "Diverged"
#fi
#if output=$(git diff --exit-code) && [ -z "$output" ]; then
UPSTREAM=${1:-'@{u}'}
LOCAL=$(git rev-parse @{0})
REMOTE=$(git rev-parse "$UPSTREAM")
BASE=$(git merge-base @{0} "$UPSTREAM")
if [ $LOCAL = $BASE ]; then
  fg_green "No changes to Pull."
else
  fg_red1 "Yes, changes to Pull."
  fg_yellow "  git pull --dry-run [to view them]"
fi
